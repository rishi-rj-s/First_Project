<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
  <meta http-equiv="x-ua-compatible" content="ie=edge" />
  <title>RISHI STUDIO</title>
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <!-- Google Fonts Roboto -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" />
  <!-- Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
    crossorigin="anonymous">
  <!-- Custom styles -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11.6.0/dist/sweetalert2.min.css">
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.6.0/dist/sweetalert2.all.min.js"></script>
  <link rel="stylesheet" href="/css/user/product_view.css" />
  <link rel="icon" href="/img/landing/favicon.png">
  <style>
    @media (min-width: 768px) {
      .form-outline-inline {
        flex-direction: row;
        align-items: center;
        margin-top: 0;
      }

      .form-outline-inline input[type="search"] {
        width: auto;
        margin-bottom: 0;
        margin-right: 5px;
      }
    }


    .banner-wrapper {
      background-color: black;
      padding: 15px;
    }

    .banner {
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
    }

    .banner h1 {
      font-family: Impact, Haettenschweiler, 'Arial Narrow Bold', sans-serif;
      padding-left: 10px;
      margin-top: 0;
      color: white;
    }

    .form-outline-inline {
      display: flex;
      align-items: center;
      margin-bottom: 10px;
    }

    .form-outline-inline input[type="search"] {
      width: 100%;
      margin-right: 5px;
    }

    .banner i {
      font-size: x-large;
      margin-right: 10px;
    }

    .icons {
      align-items: center;
    }

    .icons a {
      margin-right: 10px;
    }

    @media (min-width: 768px) {
      .banner h1 {
        margin-bottom: 0;
      }

      .form-outline-inline input[type="search"] {
        width: auto;
        margin-right: 0;
      }
    }

    .banner i {
      color: white !important;
    }

    .banner .fa-shopping-cart:hover {
      color: yellowgreen !important;
    }

    .banner .fa-heart:hover {
      color: red !important;
    }

    .banner .fa-user:hover {
      color: blue !important;
    }

    .banner .fa-power-off:hover {
      color: gray !important;
    }

    .social-icons i {
      padding-right: 10px;
    }

    .product {
      flex: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      position: relative;
    }

    .product-border {
      width: 1px;
      background-color: #ccc;
      height: 100px;
      /* Adjust according to your needs */
    }

    .product:last-child .product-border {
      display: none;
    }

    .breadcrumb {
      background-color: #f5f5f5;
      padding: 10px;
      margin-bottom: 20px;
    }

    .breadcrumb-item+.breadcrumb-item::before {
      content: ">";
      padding: 0 5px;
      color: #ccc;
    }

    .breadcrumb-item a {
      color: #333;
    }

    .breadcrumb-item.active {
      color: #777;
    }

    @media (max-width: 519px) {
      .breadcrumb {
        margin-top: 2rem;
      }
    }

    .icons i {
      font-size: 30px;
    }

    @media (max-width: 655px) {
      .breadcrumb {
        margin-top: 2.5rem;
      }
    }

    @media (max-width: 449px) {
      .breadcrumb {
        margin-top: 4.5rem;
      }
    }


    .carousel-control-prev-icon,
    .carousel-control-next-icon {
      background-color: black;
      /* Change to your desired background color */
    }

    #lens {
      z-index: 2;
      position: absolute;

      height: 200px;
      width: 200px;
      border: 0;
      background-repeat: no-repeat;
      cursor: none;

    }
  </style>



</head>

<body>
  <!-- Jumbotron -->

  <div class="banner-wrapper fixed-top">
    <div class="banner">
      <a href="/">
        <h1 class="title">RISHI STUDIO</h1>
      </a>
      <!-- <form class="form-outline-inline" method="get" required>
        <input type="search" id="form1" class="form-control" placeholder="Search" />
        <button type="submit" class="btn btn-primary shadow-0">
          <i class="fa fa-search"></i>
        </button>
      </form> -->
      <div class="icons">
        <a href="/user/cart"><i class="fa fa-shopping-cart"></i></a>
        <a href="/user/wishlist"><i class="fa fa-heart"></i></a>
        <a href="/user/profile"><i class="fa fa-user"></i></a>
        <a href="/user/logout"><i class="fa fa-power-off"></i></a>
      </div>
    </div>
  </div>



  <!-- breadcrumb content here -->
  <div class="container mt-5">
    <div class="row">
      <div class="col-12 col-md-8 mt-4">
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="/user/landing">Home</a></li>
            <li class="breadcrumb-item active" aria-current="page">Product View</li>
          </ol>
        </nav>
      </div>
      <div class="col-12 col-md-4"></div>
    </div>
  </div>

  <!-- content -->
  <section class="py-5">
    <div class="container">
      <div class="row gx-5">
        <aside class="col-lg-6 text-center">
          <div id="product-carousel" class="carousel slide border rounded-4 mb-3" data-bs-ride="carousel">
            <div class="carousel-inner mx-auto">
              <% product.images.forEach((image, index)=> { %>
                <div class="carousel-item <%= index === 0 ? 'active' : '' %>">
                  <div class="zoom-container">
                    <div id="lens-<%= index %>" class="lens"></div>
                    <img id='featured-<%= index %>' style="max-width: 100%; max-height: 100vh; margin: auto;"
                      class="rounded-4 fit" src="/<%= image %>" />
                  </div>
                </div>
                <% }); %>
            </div>
            <button class="carousel-control-prev" type="button" data-bs-target="#product-carousel" data-bs-slide="prev">
              <span class="carousel-control-prev-icon" aria-hidden="true"></span>
              <span class="visually-hidden">Previous</span>
            </button>
            <button class="carousel-control-next" type="button" data-bs-target="#product-carousel" data-bs-slide="next">
              <span class="carousel-control-next-icon" aria-hidden="true"></span>
              <span class="visually-hidden">Next</span>
            </button>
          </div>

          <div class="d-flex justify-content-center mb-3">
            <% for (let i=0; i < 4; i++) { %>
              <img width="60" height="60" class="rounded-2 border mx-1 rounded-2" src="/<%= product.images[i] %>"
                onclick="updateMainImage(this.src)" /> <!-- Add onclick event here -->
              <% } %>
          </div>
        </aside>

        <script>
          function updateMainImage(src) {
            var mainImage = document.querySelector('#product-carousel .carousel-item.active img');
            mainImage.src = src;
          }
        </script>



        <main class="col-lg-6">
          <div class="ps-lg-3">
            <h4 class="title text-dark">
              <%=product.p_name%>
            </h4>
            <div class="d-flex flex-row my-3">
              <div class="text-warning mb-1 me-2">
                <i class="fa fa-star"></i>
                <i class="fa fa-star"></i>
                <i class="fa fa-star"></i>
                <i class="fa fa-star"></i>
                <i class="fa fa-star-half-alt"></i>
                <span class="ms-1">
                  4.5
                </span>
              </div>
              <!-- <span class="text-muted"><i class="fa fa-shopping-basket fa-sm mx-1"></i>154 orders</span> -->
              <% if(product.stock>0){ %>
                <span class="text-success ms-2">In stock</span>
                <%} else {%>
                  <span class="text-danger ms-2">Out of Stock</span>
                  <%}%>
            </div>

            <div class="mb-3">
              <span class="h3">$<%=(product.total_price - product.offerDiscount)%></span>
              <span class="text-muted">&nbsp;<del>$<%=product.price%></del></span>
            </div>

            <p style="color: green; font-weight: 700;">
              <%=product.discount%>% Discount
            </p>
            <%if(product.offerActive){%>
            <p style="color: green; font-weight: 700;">
              Rs.<%=product.offerDiscount%> Offer Discount!!
            </p>
            <%}%>

            <p>
              <%=product.description%>
            </p>

            <hr />

            <% if(product.stock> 0) { %>
              <a href="/user/addtocart/<%= product._id %>" class="btn btn-primary shadow-0" id="addToCartBtn">
                <i class="me-1 fa fa-shopping-basket"></i> Add to cart
              </a>
            <% } %>

            <a href="/user/addwishlist/<%= product._id%>"
              class="btn btn-light border border-secondary py-2 icon-hover px-3 ms-3"> <i
                class="me-1 fa fa-heart fa-lg"></i> Wish 
            </a>
              
          </div>
        </main>
      </div>
    </div>
  </section>
  <!-- content -->

  <%if(similar.length> 1){%>
    <section class="bg-light border-top py-4">
      <div class="container">
        <div class="row gx-4">
          <div class="col-lg-12">
            <div class="px-0 border rounded-2 shadow-0">
              <div class="card">
                <div class="card-body">
                  <h5 class="card-title">Similar items</h5>
                  <div class="d-flex mb-3">
                    <%for(i=0;i<similar.length;i++){%>
                      <%if(similar[i]._id.toString()===product._id.toString()) {continue;}%>
                        <div class="product">
                          <a href="/user/productview/<%= similar[i]._id %>" class="me-3">
                            <img src="/<%=similar[i].images[0]%>" style="min-width: 96px; height: 96px;"
                              class="img-md img-thumbnail" />
                          </a>
                          <div class="info">
                            <a href="/user/productview/<%= similar[i]._id %>" class="nav-link mb-1">
                              <%=similar[i].p_name%>
                            </a>
                            <strong class="text-dark ms-3"> $<%=similar[i].total_price%>.00</strong>
                          </div>
                        </div>
                        <%}%>
                          <div class="product-border"></div> <!-- Border between products -->
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
    <%}%>
      <!-- content -->

      <!-- MDB -->
      <script type="text/javascript" src="js/mdb.min.js"></script>
      <!-- Custom scripts -->
      <script type="text/javascript" src="js/script.js"></script>
      <!-- Bootstrap -->
      <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
        crossorigin="anonymous"></script>

      <%- include('footer') -%>