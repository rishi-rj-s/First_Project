<!DOCTYPE html>
<html lang="en">

<head>
     <meta charset="UTF-8" />
     <meta name="viewport" content="width=device-width, initial-scale=1.0" />
     <title>Wishlist</title>
     <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" />
     <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" />
     <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11.6.0/dist/sweetalert2.min.css">
     <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.6.0/dist/sweetalert2.all.min.js"></script>
     <style>
          body {
               font-family: "Times New Roman", Times, serif sans-serif;
               background-color: #f8f9fa;
               color: #333;
               height: 100svh;
          }

          .banner-wrapper {
               background-color: black;
               padding: 10px;
          }

          .banner {
               display: flex;
               justify-content: space-between;
               align-items: center;
               flex-wrap: wrap;
          }

          .banner h1 {
               font-family: Impact, Haettenschweiler, 'Arial Narrow Bold', sans-serif;
               padding-left: 10px;
               margin-top: 0;
               color: white;
          }

          .icons {
               align-items: center;
          }

          .icons a {
               margin-right: 10px;
          }

          @media (min-width: 768px) {
               .banner h1 {
                    margin-bottom: 0;
               }
          }

          .banner i {
               color: white !important;
          }

          .banner .fa-shopping-cart:hover {
               color: yellowgreen !important;
          }

          .banner .fa-heart:hover {
               color: red !important;
          }

          .banner .fa-user:hover {
               color: blue !important;
          }

          .banner .fa-power-off:hover {
               color: gray !important;
          }

          .social-icons i {
               padding-right: 10px;
          }

          .content {
               padding: 10px;
          }

          .object-fit-cover {
               object-fit: cover;
               height: 150px;
               width: 150px
          }

          .wishlist-items .card {
               overflow: hidden;
               /* Hide any overflow content */
               height: 100%;
          }

          .wishlist-items .card-title {
               font-size: 1rem;
               /* Adjust font size of the card title */
               margin-bottom: 0.5rem;
               /* Adjust margin as needed */
          }

          .wishlist-items .card-text {
               font-size: small;
               /* Adjust font size of the card text */
               margin-bottom: 0;
          }

          .wishlist-items .btn {
               padding: 0.25rem 0.5rem;
               /* Adjust padding of buttons as needed */
               font-size: smaller;
               /* Adjust font size of buttons as needed */
          }

          .icons i {
               font-size: 30px;
          }

          .custom-container {
               display: flex;
               justify-content: center;
               align-items: center;
               min-height: 50vh;
               /* Adjust as needed */
          }

          .centered-message {
               text-align: center;
          }
     </style>
</head>

<body>
     <div class="banner-wrapper fixed-top">
          <div class="banner">
               <a href="/">
                    <h1>RISHI STUDIO</h1>
               </a>
               <!-- <form class="form-outline-inline" action="/product/search" method="get" required>
                  <input type="search" id="form1" class="form-control" placeholder="Search" />
                  <button type="submit" class="btn btn-primary shadow-0">
                      <i class="fa fa-search"></i>
                  </button>
              </form> -->
               <div class="icons">
                    <a href="/user/cart"><i class="fa fa-shopping-cart"></i></a>
                    <a href="/user/wishlist"><i class="fa fa-heart"></i></a>
                    <a href="/user/profile"><i class="fa fa-user"></i></a>
                    <a href="/user/logout"><i class="fa fa-power-off"></i></a>
               </div>
          </div>
     </div>

     <div class="navbar-wrapper">
          <nav class=" navbar-inverse  bg-dark">
               <div class="container-fluid">
                    <div class="navbar-header">
                         <!-- Responsive button -->
                         <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navi"
                              aria-label="Toggle navigation">
                              <span class="icon-bar"></span>
                              <span class="icon-bar"></span>
                              <span class="icon-bar"></span>
                         </button>
                    </div>
               </div>
          </nav>
     </div>

     <!--  NAVIGATION ENDS  -->
     <div class="container-fluid mt-5 mb-3" style="height: 70%;">
          <div class="row">
               <main role="main" class="col-md-9 ml-sm-auto col-lg-12 px-md-4 mb-4">
                    <div class="container mt-4 mb-4">
                         <div class="row">
                              <div class="col-md-8 offset-md-2 col-lg-8 offset-lg-2">
                                   <h1 class="text-center mt-3 mb-4">My Wish List</h1>
                                   <div class="wishlist-items">
                                        <% if(items.length>0){items.forEach((item)=> { %>
                                             <div class="card">
                                                  <div class="card-body">
                                                       <div class="row align-items-center">
                                                            <div class="col-md-4">
                                                                 <img src="<%= item.product.images[0] %>"
                                                                      alt="Product Image"
                                                                      class="img-fluid object-fit-cover" />
                                                            </div>
                                                            <div class="col-md-8">
                                                                 <h4 class="card-title">
                                                                      <%= item.product.name %>
                                                                 </h4>
                                                                 <p class="card-text">
                                                                      <%= item.product.description %>
                                                                 </p>
                                                                 <h5>
                                                                      $<%= (item.product.total_price - item.product.offerDiscount) %> <strike
                                                                                style="font-size: medium;">$<%=
                                                                                     item.product.price %></strike>
                                                                 </h5>
                                                                 <h7 style="color: green; font-weight: 700;">
                                                                      <%= item.product.discount %>% Discount
                                                                 </h7><br>
                                                                 <%if(item.product.offerActive){%>
                                                                      <h7 style="color: green; font-weight: 600;">
                                                                        Rs.<%=item.product.offerDiscount%> Offer Discount!!
                                                                      </h7>
                                                                      <%}%>
                                                                 <div class="d-flex mt-1" style="gap: 10px;">
                                                                      <% if(item.product.stock> 0) { %>
                                                                           <a href="/user/addtocart/<%= item.product._id%>"
                                                                                class="btn btn-primary me-2">
                                                                                <i class="fas fa-shopping-cart"></i> Add
                                                                                to
                                                                                Cart
                                                                           </a>
                                                                           <% } else { %>
                                                                                <p class="card-text text-danger mt-1">
                                                                                     Item out of Stock
                                                                                </p>
                                                                                <% } %>
                                                                                     <a
                                                                                          href="/user/removeWish/<%= item.product._id %>"><button
                                                                                               type="button"
                                                                                               class="btn btn-danger">
                                                                                               <i
                                                                                                    class="fas fa-trash"></i>
                                                                                               Remove
                                                                                          </button></a>
                                                                 </div>
                                                            </div>
                                                       </div>
                                                  </div>
                                             </div>
                                             <%})} else{%>
                                                  <div class="container custom-container">
                                                       <div class="centered-message">
                                                            <h1 class="bg-dark p-4 rounded text-white">Nothing Here!</h1>
                                                       </div>
                                                  </div>
                                                  <%}%>

                                   </div>
                                   <div class="pagination justify-content-center">
                                        <button id="prevPage" class="page-link">&laquo; Prev</button>
                                        <button id="nextPage" class="page-link">Next &raquo;</button>
                                   </div>
                              </div>
                         </div>
                    </div>
               </main>

               <script>
                    const itemsPerPage = 2; // Number of wishlist items to display per page
                    let currentPage = 1;

                    // Function to display wishlist items based on current page
                    function displayWishlistItems() {
                         const wishlistItems = document.querySelectorAll('.wishlist-items .card');
                         const numPages = Math.ceil(wishlistItems.length / itemsPerPage);

                         // Hide all wishlist items
                         wishlistItems.forEach(item => item.style.display = 'none');

                         // Calculate start and end index for current page
                         const startIndex = (currentPage - 1) * itemsPerPage;
                         const endIndex = Math.min(startIndex + itemsPerPage, wishlistItems.length);

                         // Display wishlist items for current page
                         for (let i = startIndex; i < endIndex; i++) {
                              wishlistItems[i].style.display = 'block';
                         }

                         // Disable/enable prev/next buttons based on current page
                         const prevButton = document.getElementById('prevPage');
                         const nextButton = document.getElementById('nextPage');

                         prevButton.style.display = (currentPage === 1 || numPages <= 1) ? 'none' : 'inline-block';
                         nextButton.style.display = (currentPage === numPages || numPages <= 1) ? 'none' : 'inline-block';
                    }

                    // Event listener for next page button
                    document.getElementById('nextPage').addEventListener('click', () => {
                         const numPages = Math.ceil(document.querySelectorAll('.wishlist-items .card').length / itemsPerPage);
                         if (currentPage < numPages) {
                              currentPage++;
                              displayWishlistItems();
                         }
                    });

                    // Event listener for previous page button
                    document.getElementById('prevPage').addEventListener('click', () => {
                         if (currentPage > 1) {
                              currentPage--;
                              displayWishlistItems();
                         }
                    });

                    // Initial display of wishlist items
                    displayWishlistItems();
               </script>
               <script>
                    const urlParams = new URLSearchParams(window.location.search);
                    const message = urlParams.get('msg'); // Change 'message' to 'msg'
                    if (typeof message !== 'undefined') {
                         if (message.includes('exist')) {
                              Swal.fire({
                                   title: "Exists",
                                   text: "Items already exists in Wishlist",
                                   icon: "error",
                                   confirmButtonText: 'OK'
                              });
                              window.history.replaceState({}, document.title, window.location.pathname);
                         } else if (message.includes('added')) {
                              Swal.fire({
                                   title: "Success",
                                   text: "Item successfully added",
                                   icon: "success",
                                   confirmButtonText: 'Cool'
                              });
                              window.history.replaceState({}, document.title, window.location.pathname);
                         } else if (message.includes('delete')) {
                              Swal.fire({
                                   title: "Success",
                                   text: "Item removed from wishlist",
                                   icon: "success",
                                   confirmButtonText: 'OK'
                              });
                              window.history.replaceState({}, document.title, window.location.pathname);
                         }
                    }
               </script>
          </div>
     </div>

     <!--  FOOTER MARKUP STARTS  -->

     <footer class="bg-dark text-light py-5">
          <div class="container">
               <div class="row">
                    <div class="col-md-6 mb-4 mb-md-0">
                         <h5>Connect with Us</h5>
                         <p>Follow us on social media for updates:</p>
                         <div class="social-icons">
                              <a href="#" class="me-2"><i class="fa fa-facebook text-primary"></i></a>
                              <a href="#" class="me-2"><i class="fa fa-twitter text-info"></i></a>
                              <a href="#" class="me-2"><i class="fa fa-instagram text-danger"></i></a>
                              <a href="#" class="me-2"><i class="fa fa-linkedin text-info"></i></a>
                         </div>
                    </div>
                    <div class="col-md-6">
                         <h5>Contact Us</h5>
                         <p>Email: info@example.com</p>
                         <p>Phone: +1 234 567 890</p>
                    </div>
               </div>
          </div>
     </footer>


     <!--  FOOTER MARKUP ENDS  -->




     <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
     <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.4/dist/umd/popper.min.js"></script>
     <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
</body>

</html>